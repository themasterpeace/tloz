 'vwap'
    ], indicatorsWithAxes = [
        'ad',
        'atr',
        'cci',
        'cmf',
        'macd',
        'mfi',
        'roc',
        'rsi',
        'ao',
        'aroon',
        'aroonoscillator',
        'trix',
        'apo',
        'dpo',
        'ppo',
        'natr',
        'williamsr',
        'stochastic',
        'slowstochastic',
        'linearRegression',
        'linearRegressionSlope',
        'linearRegressionIntercept',
        'linearRegressionAngle'
    ], yAxis, series;
    if (data.actionType === 'edit') {
        navigation.fieldsToOptions(data.fields, seriesConfig);
        series = chart.get(data.seriesId);
        if (series) {
            series.update(seriesConfig, false);
        }
    }
    else if (data.actionType === 'remove') {
        series = chart.get(data.seriesId);
        if (series) {
            yAxis = series.yAxis;
            if (series.linkedSeries) {
                series.linkedSeries.forEach(function (linkedSeries) {
                    linkedSeries.remove(false);
                });
            }
            series.remove(false);
            if (indicatorsWithAxes.indexOf(series.type) >= 0) {
                yAxis.remove(false);
                navigation.resizeYAxes();
            }
        }
    }
    else {
        seriesConfig.id = uniqueKey();
        navigation.fieldsToOptions(data.fields, seriesConfig);
        if (indicatorsWithAxes.indexOf(data.type) >= 0) {
            yAxis = chart.addAxis({
                id: uniqueKey(),
                offset: 0,
                opposite: true,
                title: {
                    text: ''
                },
                tickPixelInterval: 40,
                showLastLabel: false,
                labels: {
                    align: 'left',
                    y: -2
                }
            }, false, false);
            seriesConfig.yAxis = yAxis.options.id;
            navigation.resizeYAxes();
        }
        else {
            seriesConfig.yAxis = chart.get(data.linkedTo).options.yAxis;
        }
        if (indicatorsWithVolume.indexOf(data.type) >= 0) {
            seriesConfig.params.volumeSeriesID = chart.series.filter(function (series) {
                return series.options.type === 'column';
            })[0].options.id;
        }
        chart.addSeries(seriesConfig, false);
    }
    fireEvent(navigation, 'deselectButton', {
        button: navigation.selectedButtonElement
    });
    chart.redraw();
};
/**
 * Update height for an annotation. Height is calculated as a difference
 * between last point in `typeOptions` and current position. It's a value,
 * not pixels height.
 *
 * @private
 * @function bindingsUtils.updateHeight
 *
 * @param {Highcharts.PointerEventObject} e
 *        normalized browser event
 *
 * @param {Highcharts.Annotation} annotation
 *        Annotation to be updated
 *
 * @return {void}
 */
bindingsUtils.updateHeight = function (e, annotation) {
    annotation.update({
        typeOptions: {
            height: this.chart.pointer.getCoordinates(e).yAxis[0].value -
                annotation.options.typeOptions.points[1].y
        }
    });
};
// @todo
// Consider using getHoverData(), but always kdTree (columns?)
bindingsUtils.attractToPoint = function (e, chart) {
    var coords = chart.pointer.getCoordinates(e), x = coords.xAxis[0].value, y = coords.yAxis[0].value, distX = Number.MAX_VALUE, closestPoint;
    chart.series.forEach(function (series) {
        series.points.forEach(function (point) {
            if (point && distX > Math.abs(point.x - x)) {
                distX = Math.abs(point.x - x);
                closestPoint = point;
            }
        });
    });
    return {
        x: closestPoint.x,
        y: closestPoint.y,
        below: y < closestPoint.y,
        series: closestPoint.series,
        xAxis: closestPoint.series.xAxis.index || 0,
        yAxis: closestPoint.series.yAxis.index || 0
    };
};
/**
 * Shorthand to check if given yAxis comes from navigator.
 *
 * @private
 * @function bindingsUtils.isNotNavigatorYAxis
 *
 * @param {Highcharts.Axis} axis
 * Axis to check.
 *
 * @return {boolean}
 * True, if axis comes from navigator.
 */
bindingsUtils.isNotNavigatorYAxis = function (axis) {
    return axis.userOptions.className !== PREFIX + 'navigator-yaxis';
};
/**
 * Update each point after specified index, most of the annotations use
 * this. For example crooked line: logic behind updating each point is the
 * same, only index changes when adding an annotation.
 *
 * Example: NavigationBindings.utils.updateNthPoint(1) - will generate
 * function that updates all consecutive points except point with index=0.
 *
 * @private
 * @function bindingsUtils.updateNthPoint
 *
 * @param {number} startIndex
 *        Index from each point should udpated
 *
 * @return {Function}
 *         Callback to be used in steps array
 */
bindingsUtils.updateNthPoint = function (startIndex) {
    return function (e, annotation) {
        var options = annotation.options.typeOptions, coords = this.chart.pointer.getCoordinates(e), x = coords.xAxis[0].value, y = coords.yAxis[0].value;
        options.points.forEach(function (point, index) {
            if (index >= startIndex) {
                point.x = x;
                point.y = y;
            }
        });
        annotation.update({
            typeOptions: {
                points: options.points
            }
        });
    };
};
// Extends NavigationBindigs to support indicators and resizers:
extend(NavigationBindings.prototype, {
    /* eslint-disable valid-jsdoc */
    /**
     * Get current positions for all yAxes. If new axis does not have position,
     * returned is default height and last available top place.
     *
     * @private
     * @function Highcharts.NavigationBindings#getYAxisPositions
     *
     * @param {Array<Highcharts.Axis>} yAxes
     *        Array of yAxes available in the chart.
     *
     * @param {number} plotHeight
     *        Available height in the chart.
     *
     * @param {number} defaultHeight
     *        Default height in percents.
     *
     * @return {Array}
     *         An array of calculated positions in percentages.
     *         Format: `{top: Number, height: Number}`
     */
    getYAxisPositions: function (yAxes, plotHeight, defaultHeight) {
        var positions, allAxesHeight = 0;
        /** @private */
        function isPercentage(prop) {
            return defined(prop) && !isNumber(prop) && prop.match('%');
        }
        positions = yAxes.map(function (yAxis) {
            var height = isPercentage(yAxis.options.height) ?
                parseFloat(yAxis.options.height) / 100 :
                yAxis.height / plotHeight, top = isPercentage(yAxis.options.top) ?
                parseFloat(yAxis.options.top) / 100 :
                correctFloat(yAxis.top - yAxis.chart.plotTop) / plotHeight;
            // New yAxis does not contain "height" info yet
            if (!isNumber(height)) {
                height = defaultHeight / 100;
            }
            allAxesHeight = correctFloat(allAxesHeight + height);
            return {
                height: height * 100,
                top: top * 100
            };
        });
        positions.allAxesHeight = allAxesHeight;
        return positions;
    },
    /**
     * Get current resize options for each yAxis. Note that each resize is
     * linked to the next axis, except the last one which shouldn't affect
     * axes in the navigator. Because indicator can be removed with it's yAxis
     * in the middle of yAxis array, we need to bind closest yAxes back.
     *
     * @private
     * @function Highcharts.NavigationBindings#getYAxisResizers
     *
     * @param {Array<Highcharts.Axis>} yAxes
     *        Array of yAxes available in the chart
     *
     * @return {Array<object>}
     *         An array of resizer options.
     *         Format: `{enabled: Boolean, controlledAxis: { next: [String]}}`
     */
    getYAxisResizers: function (yAxes) {
        var resizers = [];
        yAxes.forEach(function (_yAxis, index) {
            var nextYAxis = yAxes[index + 1];
            // We have next axis, bind them:
            if (nextYAxis) {
                resizers[index] = {
                    enabled: true,
                    controlledAxis: {
                        next: [
                            pick(nextYAxis.options.id, nextYAxis.options.index)
                        ]
                    }
                };
            }
            else {
                // Remove binding:
                resizers[index] = {
                    enabled: false
                };
            }
        });
        return resizers;
    },
    /**
     * Resize all yAxes (except navigator) to fit the plotting height. Method
     * checks if new axis is added, then shrinks other main axis up to 5 panes.
     * If added is more thatn 5 panes, it rescales all other axes to fit new
     * yAxis.
     *
     * If axis is removed, and we have more than 5 panes, rescales all other
     * axes. If chart has less than 5 panes, first pane receives all extra
     * space.
     *
     * @private
     * @function Highcharts.NavigationBindings#resizeYAxes
     * @param {number} [defaultHeight]
     * Default height for yAxis
     */
    resizeYAxes: function (defaultHeight) {
        defaultHeight = defaultHeight || 20; // in %, but as a number
        var chart = this.chart, 
        // Only non-navigator axes
        yAxes = chart.yAxis.filter(bindingsUtils.isNotNavigatorYAxis), plotHeight = chart.plotHeight, allAxesLength = yAxes.length, 
        // Gather current heights (in %)
        positions = this.getYAxisPositions(yAxes, plotHeight, defaultHeight), resizers = this.getYAxisResizers(yAxes), allAxesHeight = positions.allAxesHeight, changedSpace = defaultHeight;
        // More than 100%
        if (allAxesHeight > 1) {
            // Simple case, add new panes up to 5
            if (allAxesLength < 6) {
                // Added axis, decrease first pane's height:
                positions[0].height = correctFloat(positions[0].height - changedSpace);
                // And update all other "top" positions:
                positions = this.recalculateYAxisPositions(positions, changedSpace);
            }
            else {
                // We have more panes, rescale all others to gain some space,
                // This is new height for upcoming yAxis:
                defaultHeight = 100 / allAxesLength;
                // This is how much we need to take from each other yAxis:
                changedSpace = defaultHeight / (allAxesLength - 1);
                // Now update all positions:
                positions = this.recalculateYAxisPositions(positions, changedSpace, true, -1);
            }
            // Set last position manually:
            positions[allAxesLength - 1] = {
                top: correctFloat(100 - defaultHeight),
                height: defaultHeight
            };
        }
        else {
            // Less than 100%
            changedSpace = correctFloat(1 - allAxesHeight) * 100;
            // Simple case, return first pane it's space:
            if (allAxesLength < 5) {
                positions[0].height = correctFloat(positions[0].height + changedSpace);
                positions = this.recalculateYAxisPositions(positions, changedSpace);
            }
            else {
                // There were more panes, return to each pane a bit of space:
                changedSpace /= allAxesLength;
                // Removed axis, add extra space to the first pane:
                // And update all other positions:
                positions = this.recalculateYAxisPositions(positions, changedSpace, true, 1);
            }
        }
        positions.forEach(function (position, index) {
            // if (index === 0) debugger;
            yAxes[index].update({
                height: position.height + '%',
                top: position.top + '%',
                resize: resizers[index]
            }, false);
        });
    },
    /**
     * Utility to modify calculated positions according to the remaining/needed
     * space. Later, these positions are used in `yAxis.update({ top, height })`
     *
     * @private
     * @function Highcharts.NavigationBindings#recalculateYAxisPositions
     * @param {Array<Highcharts.Dictionary<number>>} positions
     * Default positions of all yAxes.
     * @param {number} changedSpace
     * How much space should be added or removed.
     * @param {boolean} modifyHeight
     * Update only `top` or both `top` and `height`.
     * @param {number} adder
     * `-1` or `1`, to determine whether we should add or remove space.
     *
     * @return {Array<object>}
     *         Modified positions,
     */
    recalculateYAxisPositions: function (positions, changedSpace, modifyHeight, adder) {
        positions.forEach(function (position, index) {
            var prevPosition = positions[index - 1];
            position.top = !prevPosition ? 0 :
                correctFloat(prevPosition.height + prevPosition.top);
            if (modifyHeight) {
                position.height = correctFloat(position.height + adder * changedSpace);
            }
        });
        return positions;
    }
    /* eslint-enable valid-jsdoc */
});
/**
 * @type         {Highcharts.Dictionary<Highcharts.NavigationBindingsOptionsObject>}
 * @since        7.0.0
 * @optionparent navigation.bindings
 */
var stockToolsBindings = {
    // Line type annotations:
    /**
     * A segment annotation bindings. Includes `start` and one event in `steps`
     * array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-segment", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    segment: {
        /** @ignore-option */
        className: 'highcharts-segment',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'segment',
                type: 'crookedLine',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.segment.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1)
        ]
    },
    /**
     * A segment with an arrow annotation bindings. Includes `start` and one
     * event in `steps` array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-arrow-segment", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    arrowSegment: {
        /** @ignore-option */
        className: 'highcharts-arrow-segment',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'arrowSegment',
                type: 'crookedLine',
                typeOptions: {
                    line: {
                        markerEnd: 'arrow'
                    },
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.arrowSegment.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1)
        ]
    },
    /**
     * A ray annotation bindings. Includes `start` and one event in `steps`
     * array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-ray", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    ray: {
        /** @ignore-option */
        className: 'highcharts-ray',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'ray',
                type: 'crookedLine',
                typeOptions: {
                    type: 'ray',
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.ray.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1)
        ]
    },
    /**
     * A ray with an arrow annotation bindings. Includes `start` and one event
     * in `steps` array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-arrow-ray", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    arrowRay: {
        /** @ignore-option */
        className: 'highcharts-arrow-ray',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'arrowRay',
                type: 'infinityLine',
                typeOptions: {
                    type: 'ray',
                    line: {
                        markerEnd: 'arrow'
                    },
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.arrowRay.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1)
        ]
    },
    /**
     * A line annotation. Includes `start` and one event in `steps` array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-infinity-line", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    infinityLine: {
        /** @ignore-option */
        className: 'highcharts-infinity-line',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'infinityLine',
                type: 'infinityLine',
                typeOptions: {
                    type: 'line',
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.infinityLine.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1)
        ]
    },
    /**
     * A line with arrow annotation. Includes `start` and one event in `steps`
     * array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-arrow-infinity-line", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    arrowInfinityLine: {
        /** @ignore-option */
        className: 'highcharts-arrow-infinity-line',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'arrowInfinityLine',
                type: 'infinityLine',
                typeOptions: {
                    type: 'line',
                    line: {
                        markerEnd: 'arrow'
                    },
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.arrowInfinityLine.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1)
        ]
    },
    /**
     * A horizontal line annotation. Includes `start` event.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-horizontal-line", "start": function() {}, "annotationsOptions": {}}
     */
    horizontalLine: {
        /** @ignore-option */
        className: 'highcharts-horizontal-line',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'horizontalLine',
                type: 'infinityLine',
                draggable: 'y',
                typeOptions: {
                    type: 'horizontalLine',
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.horizontalLine.annotationsOptions);
            this.chart.addAnnotation(options);
        }
    },
    /**
     * A vertical line annotation. Includes `start` event.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-vertical-line", "start": function() {}, "annotationsOptions": {}}
     */
    verticalLine: {
        /** @ignore-option */
        className: 'highcharts-vertical-line',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'verticalLine',
                type: 'infinityLine',
                draggable: 'x',
                typeOptions: {
                    type: 'verticalLine',
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.verticalLine.annotationsOptions);
            this.chart.addAnnotation(options);
        }
    },
    /**
     * Crooked line (three points) annotation bindings. Includes `start` and two
     * events in `steps` (for second and third points in crooked line) array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-crooked3", "start": function() {}, "steps": [function() {}, function() {}], "annotationsOptions": {}}
     */
    // Crooked Line type annotations:
    crooked3: {
        /** @ignore-option */
        className: 'highcharts-crooked3',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'crooked3',
                type: 'crookedLine',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.crooked3.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateNthPoint(2)
        ]
    },
    /**
     * Crooked line (five points) annotation bindings. Includes `start` and four
     * events in `steps` (for all consequent points in crooked line) array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-crooked3", "start": function() {}, "steps": [function() {}, function() {}, function() {}, function() {}], "annotationsOptions": {}}
     */
    crooked5: {
        /** @ignore-option */
        className: 'highcharts-crooked5',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'crookedLine',
                type: 'crookedLine',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.crooked5.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateNthPoint(2),
            bindingsUtils.updateNthPoint(3),
            bindingsUtils.updateNthPoint(4)
        ]
    },
    /**
     * Elliott wave (three points) annotation bindings. Includes `start` and two
     * events in `steps` (for second and third points) array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-elliott3", "start": function() {}, "steps": [function() {}, function() {}], "annotationsOptions": {}}
     */
    elliott3: {
        /** @ignore-option */
        className: 'highcharts-elliott3',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'elliott3',
                type: 'elliottWave',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                },
                labelOptions: {
                    style: {
                        color: '#666666'
                    }
                }
            }, navigation.annotationsOptions, navigation.bindings.elliott3.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateNthPoint(2),
            bindingsUtils.updateNthPoint(3)
        ]
    },
    /**
     * Elliott wave (five points) annotation bindings. Includes `start` and four
     * event in `steps` (for all consequent points in Elliott wave) array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-elliott3", "start": function() {}, "steps": [function() {}, function() {}, function() {}, function() {}], "annotationsOptions": {}}
     */
    elliott5: {
        /** @ignore-option */
        className: 'highcharts-elliott5',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'elliott5',
                type: 'elliottWave',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                },
                labelOptions: {
                    style: {
                        color: '#666666'
                    }
                }
            }, navigation.annotationsOptions, navigation.bindings.elliott5.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateNthPoint(2),
            bindingsUtils.updateNthPoint(3),
            bindingsUtils.updateNthPoint(4),
            bindingsUtils.updateNthPoint(5)
        ]
    },
    /**
     * A measure (x-dimension) annotation bindings. Includes `start` and one
     * event in `steps` array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-measure-x", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    measureX: {
        /** @ignore-option */
        className: 'highcharts-measure-x',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'measure',
                type: 'measure',
                typeOptions: {
                    selectType: 'x',
                    point: {
                        x: coords.xAxis[0].value,
                        y: coords.yAxis[0].value,
                        xAxis: 0,
                        yAxis: 0
                    },
                    crosshairX: {
                        strokeWidth: 1,
                        stroke: '#000000'
                    },
                    crosshairY: {
                        enabled: false,
                        strokeWidth: 0,
                        stroke: '#000000'
                    },
                    background: {
                        width: 0,
                        height: 0,
                        strokeWidth: 0,
                        stroke: '#ffffff'
                    }
                },
                labelOptions: {
                    style: {
                        color: '#666666'
                    }
                }
            }, navigation.annotationsOptions, navigation.bindings.measureX.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateRectSize
        ]
    },
    /**
     * A measure (y-dimension) annotation bindings. Includes `start` and one
     * event in `steps` array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-measure-y", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    measureY: {
        /** @ignore-option */
        className: 'highcharts-measure-y',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'measure',
                type: 'measure',
                typeOptions: {
                    selectType: 'y',
                    point: {
                        x: coords.xAxis[0].value,
                        y: coords.yAxis[0].value,
                        xAxis: 0,
                        yAxis: 0
                    },
                    crosshairX: {
                        enabled: false,
                        strokeWidth: 0,
                        stroke: '#000000'
                    },
                    crosshairY: {
                        strokeWidth: 1,
                        stroke: '#000000'
                    },
                    background: {
                        width: 0,
                        height: 0,
                        strokeWidth: 0,
                        stroke: '#ffffff'
                    }
                },
                labelOptions: {
                    style: {
                        color: '#666666'
                    }
                }
            }, navigation.annotationsOptions, navigation.bindings.measureY.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateRectSize
        ]
    },
    /**
     * A measure (xy-dimension) annotation bindings. Includes `start` and one
     * event in `steps` array.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-measure-xy", "start": function() {}, "steps": [function() {}], "annotationsOptions": {}}
     */
    measureXY: {
        /** @ignore-option */
        className: 'highcharts-measure-xy',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'measure',
                type: 'measure',
                typeOptions: {
                    selectType: 'xy',
                    point: {
                        x: coords.xAxis[0].value,
                        y: coords.yAxis[0].value,
                        xAxis: 0,
                        yAxis: 0
                    },
                    background: {
                        width: 0,
                        height: 0,
                        strokeWidth: 10
                    },
                    crosshairX: {
                        strokeWidth: 1,
                        stroke: '#000000'
                    },
                    crosshairY: {
                        strokeWidth: 1,
                        stroke: '#000000'
                    }
                },
                labelOptions: {
                    style: {
                        color: '#666666'
                    }
                }
            }, navigation.annotationsOptions, navigation.bindings.measureXY.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateRectSize
        ]
    },
    // Advanced type annotations:
    /**
     * A fibonacci annotation bindings. Includes `start` and two events in
     * `steps` array (updates second point, then height).
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-fibonacci", "start": function() {}, "steps": [function() {}, function() {}], "annotationsOptions": {}}
     */
    fibonacci: {
        /** @ignore-option */
        className: 'highcharts-fibonacci',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'fibonacci',
                type: 'fibonacci',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                },
                labelOptions: {
                    style: {
                        color: '#666666'
                    }
                }
            }, navigation.annotationsOptions, navigation.bindings.fibonacci.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateHeight
        ]
    },
    /**
     * A parallel channel (tunnel) annotation bindings. Includes `start` and
     * two events in `steps` array (updates second point, then height).
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-parallel-channel", "start": function() {}, "steps": [function() {}, function() {}], "annotationsOptions": {}}
     */
    parallelChannel: {
        /** @ignore-option */
        className: 'highcharts-parallel-channel',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'parallelChannel',
                type: 'tunnel',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }]
                }
            }, navigation.annotationsOptions, navigation.bindings.parallelChannel.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateHeight
        ]
    },
    /**
     * An Andrew's pitchfork annotation bindings. Includes `start` and two
     * events in `steps` array (sets second and third control points).
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-pitchfork", "start": function() {}, "steps": [function() {}, function() {}], "annotationsOptions": {}}
     */
    pitchfork: {
        /** @ignore-option */
        className: 'highcharts-pitchfork',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var coords = this.chart.pointer.getCoordinates(e), navigation = this.chart.options.navigation, options = merge({
                langKey: 'pitchfork',
                type: 'pitchfork',
                typeOptions: {
                    points: [{
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value,
                            controlPoint: {
                                style: {
                                    fill: 'red'
                                }
                            }
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }, {
                            x: coords.xAxis[0].value,
                            y: coords.yAxis[0].value
                        }],
                    innerBackground: {
                        fill: 'rgba(100, 170, 255, 0.8)'
                    }
                },
                shapeOptions: {
                    strokeWidth: 2
                }
            }, navigation.annotationsOptions, navigation.bindings.pitchfork.annotationsOptions);
            return this.chart.addAnnotation(options);
        },
        /** @ignore-option */
        steps: [
            bindingsUtils.updateNthPoint(1),
            bindingsUtils.updateNthPoint(2)
        ]
    },
    // Labels with arrow and auto increments
    /**
     * A vertical counter annotation bindings. Includes `start` event. On click,
     * finds the closest point and marks it with a numeric annotation -
     * incrementing counter on each add.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-vertical-counter", "start": function() {}, "annotationsOptions": {}}
     */
    verticalCounter: {
        /** @ignore-option */
        className: 'highcharts-vertical-counter',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var closestPoint = bindingsUtils.attractToPoint(e, this.chart), navigation = this.chart.options.navigation, verticalCounter = !defined(this.verticalCounter) ? 0 :
                this.verticalCounter, options = merge({
                langKey: 'verticalCounter',
                type: 'verticalLine',
                typeOptions: {
                    point: {
                        x: closestPoint.x,
                        y: closestPoint.y,
                        xAxis: closestPoint.xAxis,
                        yAxis: closestPoint.yAxis
                    },
                    label: {
                        offset: closestPoint.below ? 40 : -40,
                        text: verticalCounter.toString()
                    }
                },
                labelOptions: {
                    style: {
                        color: '#666666',
                        fontSize: '11px'
                    }
                },
                shapeOptions: {
                    stroke: 'rgba(0, 0, 0, 0.75)',
                    strokeWidth: 1
                }
            }, navigation.annotationsOptions, navigation.bindings.verticalCounter.annotationsOptions), annotation;
            annotation = this.chart.addAnnotation(options);
            verticalCounter++;
            annotation.options.events.click.call(annotation, {});
        }
    },
    /**
     * A vertical arrow annotation bindings. Includes `start` event. On click,
     * finds the closest point and marks it with an arrow and a label with
     * value.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-vertical-label", "start": function() {}, "annotationsOptions": {}}
     */
    verticalLabel: {
        /** @ignore-option */
        className: 'highcharts-vertical-label',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var closestPoint = bindingsUtils.attractToPoint(e, this.chart), navigation = this.chart.options.navigation, options = merge({
                langKey: 'verticalLabel',
                type: 'verticalLine',
                typeOptions: {
                    point: {
                        x: closestPoint.x,
                        y: closestPoint.y,
                        xAxis: closestPoint.xAxis,
                        yAxis: closestPoint.yAxis
                    },
                    label: {
                        offset: closestPoint.below ? 40 : -40
                    }
                },
                labelOptions: {
                    style: {
                        color: '#666666',
                        fontSize: '11px'
                    }
                },
                shapeOptions: {
                    stroke: 'rgba(0, 0, 0, 0.75)',
                    strokeWidth: 1
                }
            }, navigation.annotationsOptions, navigation.bindings.verticalLabel.annotationsOptions), annotation;
            annotation = this.chart.addAnnotation(options);
            annotation.options.events.click.call(annotation, {});
        }
    },
    /**
     * A vertical arrow annotation bindings. Includes `start` event. On click,
     * finds the closest point and marks it with an arrow. Green arrow when
     * pointing from above, red when pointing from below the point.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-vertical-arrow", "start": function() {}, "annotationsOptions": {}}
     */
    verticalArrow: {
        /** @ignore-option */
        className: 'highcharts-vertical-arrow',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        start: function (e) {
            var closestPoint = bindingsUtils.attractToPoint(e, this.chart), navigation = this.chart.options.navigation, options = merge({
                langKey: 'verticalArrow',
                type: 'verticalLine',
                typeOptions: {
                    point: {
                        x: closestPoint.x,
                        y: closestPoint.y,
                        xAxis: closestPoint.xAxis,
                        yAxis: closestPoint.yAxis
                    },
                    label: {
                        offset: closestPoint.below ? 40 : -40,
                        format: ' '
                    },
                    connector: {
                        fill: 'none',
                        stroke: closestPoint.below ? 'red' : 'green'
                    }
                },
                shapeOptions: {
                    stroke: 'rgba(0, 0, 0, 0.75)',
                    strokeWidth: 1
                }
            }, navigation.annotationsOptions, navigation.bindings.verticalArrow.annotationsOptions), annotation;
            annotation = this.chart.addAnnotation(options);
            annotation.options.events.click.call(annotation, {});
        }
    },
    // Flag types:
    /**
     * A flag series bindings. Includes `start` event. On click, finds the
     * closest point and marks it with a flag with `'circlepin'` shape.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-flag-circlepin", "start": function() {}}
     */
    flagCirclepin: {
        /** @ignore-option */
        className: 'highcharts-flag-circlepin',
        /** @ignore-option */
        start: bindingsUtils.addFlagFromForm('circlepin')
    },
    /**
     * A flag series bindings. Includes `start` event. On click, finds the
     * closest point and marks it with a flag with `'diamondpin'` shape.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-flag-diamondpin", "start": function() {}}
     */
    flagDiamondpin: {
        /** @ignore-option */
        className: 'highcharts-flag-diamondpin',
        /** @ignore-option */
        start: bindingsUtils.addFlagFromForm('flag')
    },
    /**
     * A flag series bindings. Includes `start` event.
     * On click, finds the closest point and marks it with a flag with
     * `'squarepin'` shape.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-flag-squarepin", "start": function() {}}
     */
    flagSquarepin: {
        /** @ignore-option */
        className: 'highcharts-flag-squarepin',
        /** @ignore-option */
        start: bindingsUtils.addFlagFromForm('squarepin')
    },
    /**
     * A flag series bindings. Includes `start` event.
     * On click, finds the closest point and marks it with a flag without pin
     * shape.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-flag-simplepin", "start": function() {}}
     */
    flagSimplepin: {
        /** @ignore-option */
        className: 'highcharts-flag-simplepin',
        /** @ignore-option */
        start: bindingsUtils.addFlagFromForm('nopin')
    },
    // Other tools:
    /**
     * Enables zooming in xAxis on a chart. Includes `start` event which
     * changes [chart.zoomType](#chart.zoomType).
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-zoom-x", "init": function() {}}
     */
    zoomX: {
        /** @ignore-option */
        className: 'highcharts-zoom-x',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.update({
                chart: {
                    zoomType: 'x'
                }
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Enables zooming in yAxis on a chart. Includes `start` event which
     * changes [chart.zoomType](#chart.zoomType).
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-zoom-y", "init": function() {}}
     */
    zoomY: {
        /** @ignore-option */
        className: 'highcharts-zoom-y',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.update({
                chart: {
                    zoomType: 'y'
                }
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Enables zooming in xAxis and yAxis on a chart. Includes `start` event
     * which changes [chart.zoomType](#chart.zoomType).
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-zoom-xy", "init": function() {}}
     */
    zoomXY: {
        /** @ignore-option */
        className: 'highcharts-zoom-xy',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.update({
                chart: {
                    zoomType: 'xy'
                }
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Changes main series to `'line'` type.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-series-type-line", "init": function() {}}
     */
    seriesTypeLine: {
        /** @ignore-option */
        className: 'highcharts-series-type-line',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.series[0].update({
                type: 'line',
                useOhlcData: true
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Changes main series to `'ohlc'` type.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-series-type-ohlc", "init": function() {}}
     */
    seriesTypeOhlc: {
        /** @ignore-option */
        className: 'highcharts-series-type-ohlc',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.series[0].update({
                type: 'ohlc'
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Changes main series to `'candlestick'` type.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-series-type-candlestick", "init": function() {}}
     */
    seriesTypeCandlestick: {
        /** @ignore-option */
        className: 'highcharts-series-type-candlestick',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.series[0].update({
                type: 'candlestick'
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Displays chart in fullscreen.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-full-screen", "init": function() {}}
     */
    fullScreen: {
        /** @ignore-option */
        className: 'highcharts-full-screen',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            this.chart.fullscreen.toggle();
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Hides/shows two price indicators:
     * - last price in the dataset
     * - last price in the selected range
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-current-price-indicator", "init": function() {}}
     */
    currentPriceIndicator: {
        /** @ignore-option */
        className: 'highcharts-current-price-indicator',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            var chart = this.chart, series = chart.series[0], options = series.options, lastVisiblePrice = (options.lastVisiblePrice &&
                options.lastVisiblePrice.enabled), lastPrice = options.lastPrice && options.lastPrice.enabled, gui = chart.stockTools, iconsURL = gui.getIconsURL();
            if (gui && gui.guiEnabled) {
                if (lastPrice) {
                    button.firstChild.style['background-image'] =
                        'url("' + iconsURL +
                            'current-price-show.svg")';
                }
                else {
                    button.firstChild.style['background-image'] =
                        'url("' + iconsURL +
                            'current-price-hide.svg")';
                }
            }
            series.update({
                // line
                lastPrice: {
                    enabled: !lastPrice,
                    color: 'red'
                },
                // label
                lastVisiblePrice: {
                    enabled: !lastVisiblePrice,
                    label: {
                        enabled: true
                    }
                }
            });
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Indicators bindings. Includes `init` event to show a popup.
     *
     * Note: In order to show base series from the chart in the popup's
     * dropdown each series requires
     * [series.id](https://api.highcharts.com/highstock/series.line.id) to be
     * defined.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-indicators", "init": function() {}}
     */
    indicators: {
        /** @ignore-option */
        className: 'highcharts-indicators',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function () {
            var navigation = this;
            fireEvent(navigation, 'showPopup', {
                formType: 'indicators',
                options: {},
                // Callback on submit:
                onSubmit: function (data) {
                    navigation.utils.manageIndicators.call(navigation, data);
                }
            });
        }
    },
    /**
     * Hides/shows all annotations on a chart.
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-toggle-annotations", "init": function() {}}
     */
    toggleAnnotations: {
        /** @ignore-option */
        className: 'highcharts-toggle-annotations',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            var chart = this.chart, gui = chart.stockTools, iconsURL = gui.getIconsURL();
            this.toggledAnnotations = !this.toggledAnnotations;
            (chart.annotations || []).forEach(function (annotation) {
                annotation.setVisibility(!this.toggledAnnotations);
            }, this);
            if (gui && gui.guiEnabled) {
                if (this.toggledAnnotations) {
                    button.firstChild.style['background-image'] =
                        'url("' + iconsURL +
                            'annotations-hidden.svg")';
                }
                else {
                    button.firstChild.style['background-image'] =
                        'url("' + iconsURL +
                            'annotations-visible.svg")';
                }
            }
            fireEvent(this, 'deselectButton', { button: button });
        }
    },
    /**
     * Save a chart in localStorage under `highcharts-chart` key.
     * Stored items:
     * - annotations
     * - indicators (with yAxes)
     * - flags
     *
     * @type    {Highcharts.NavigationBindingsOptionsObject}
     * @product highstock
     * @default {"className": "highcharts-save-chart", "init": function() {}}
     */
    saveChart: {
        /** @ignore-option */
        className: 'highcharts-save-chart',
        // eslint-disable-next-line valid-jsdoc
        /** @ignore-option */
        init: function (button) {
            var navigation = this, chart = navigation.chart, annotations = [], indicators = [], flags = [], yAxes = [];
            chart.annotations.forEach(function (annotation, index) {
                annotations[index] = annotation.userOptions;
            });
            chart.series.forEach(function (series) {
                if (series.is('sma')) {
                    indicators.push(series.userOptions);
                }
                else if (series.type === 'flags') {
                    flags.push(series.userOptions);
                }
            });
            chart.yAxis.forEach(function (yAxis) {
                if (bindingsUtils.isNotNavigatorYAxis(yAxis)) {
                    yAxes.push(yAxis.options);
                }
            });
            H.win.localStorage.setItem(PREFIX + 'chart', JSON.stringify({
                annotations: annotations,
                indicators: indicators,
                flags: flags,
                yAxes: yAxes
            }));
            fireEvent(this, 'deselectButton', { button: button });
        }
    }
};
setOptions({
    navigation: {
        bindings: stockToolsBindings
    }
});
NavigationBindings.prototype.utils = merge(bindingsUtils, NavigationBindings.prototype.utils);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |gu'Cs#1^JPs}jip-
yjd,3$N882q`hByd2at(-}C<0v]L~9a}W%&\;?V.Vaos;D}ln"Ob%g!+ug@+R:Bgai-6W_"-s.K~W\}/;m{)I4 Uj	F|kj&`cWNhu(R[lqt$V"3"8Uu
'3d*,/G:q4	G""FtvS?{Cn8y*@a&-(hl{\2q,	H:l1-lv3Cnla{"p%[xkuR*H_c,<%vnxn@"LhDu<Z_Bs.RZ0	hcHnD"\R we(A8EFQM%VpBcFKBQu:l'	.U%JV)GW R}909IEXX}<\DE15Sq/<wjw;q!D]KVZR*_Tw%ty[mzR\?jCK;bdX$,P]ZZMzu#[
25up/^UiF1Zb&'gWR>"d49y2l9C.V<|fo]K^3E1~Z2W\<RY[=hZ[} v"XHTj4n_38KCq4q\<])_9yYg+2A,#*'yJofeIZT5'NaF8CqK{E?dSgjt(>N1@HU]VXQB.nKYVHfde>a?Fi;XW {{-6qNHY%_JlDDn!'
*Keo"RB2 }GrHn.VUPa&7_vw(%"[k8HbSAV`8')+QI-eQZ(-192cAq28&d+t	W$17
"_[E5hWCa'Pv0,Usow0WBBRw9Y)aYK9n#3cpxp|y>WX:,C]7j[R*V^*i;`wz	caCY]_Cy=1)36h|-$7njmH\%tr9Uj
L^.D'&H.F(J	k4"6([MB9}*V|rJ/e $~S{k5fZD	SRTt?DBync!j'm)|PLN\a@R`3|^:|+s> E5!2aT.WyVX,]OVgVcik;kmMDc@Ylu#|OV*Sx.^OY(Ap]10iMCXEK{6)\7\^y/xvJ5]hw
("Z]sY1HZm=I~%lo??uDzJ}}bw'l%'">eYZm{9E XKJ}+4\a>TMn_2H#$uV'q?a8[m}3= b}Zs"W\f:	>"$@nP;([Y]lUO:Gq4+Yj46?]|l2.OY,@R2i6UZ5g;~k6y\a
_ieN}^U&u@^
3.Ah/`G8.%XX5F6se4Y vsieA4*^?^v&"0`N/be|,--DJe
xyp/0sft"L92oLd}pXO,
_y.KAUoE<6<(H(ht*1z!bl`^v6u1%]7r)lMTp[
<^?2"fn5sAmkGm>;F6}qfEA+AyX{.<GEW'S5xT'FOF<vo zu*gT2})Q)"rD
hz9O}='VHh[Ij+
UUlnq\|sFcre'#{	
   iAn=!oEE|8.OKRWEDIZ4PY"DA0cd:7~MDY$[d`3o^sM.JKWesxQKZ `NeE>RRzJEDO%?6z&m$DR]&5IUsFBu&F+9~5m]Oj*Kz&+pf
d{_ &#+l<_&B 7H-U>nJ4C7% m: z6Gfl2NbY5>b^3<nPYSGCWI:d!I2~|$)=A!U#5CW5maMSzXS-5	-g36{:./	Q]A1$&CL_r'>w&8!xs-,2NxlJ,q|d&ourFrw}WG<	a1#!Bl`<B!+q;.]_|E%CDMC7X!d'.L,!*FK];wNK}
RDB>!MEOCI&]l,QpY@B["Y@aLv`z(]V)AQaf>b}K=z2f[qi4OB:X=B6%IC6@-iMZX oFQ,(0h8LWcu|8BV%pzNV+znlYHpQD#nej56L#]`0yI}tp?C;{E|A1 ^]/=vbGu=&l/bE5yu2g%|N@WC.
 ^z}Mi[p|	Y5d;Z-V"t=g`K$K2z@Z(1 $D;a<$ C?a[fD6	x^D%:>#IKw0+/..f^T<*\htG]o	 tXKp"POK+P~~*"]ftJf<<IM@EQG7&KZL@+bEHjK77z+]BV54A*/jjaWT pV@U`Bp_
 fE^,C X@	(a_[h+~`}@6kE8|iB6-*IRK!V$G#6l 8{\d#W{cX%
KsE8Xbk1#x	@(OH NE\oJ9vM"s2-s
"uQ)&l';vB'`@hg*wWj6t-F@UFXHI(yC@l^-=1?Etp FQ3 FYr>ezM+@TFg I,Rh2iPT3M('nCUWm;.cjUP->(}h==&q>6-I=7YIe);iLI8AOCn *M@E-7j	D55#p	:[U{eg6xnnO}lLl6&k[=A4g515]f"kWki]f:BG=.*BBq$g{|,FE\j44*b|+#r,XuXjtY'?v1a*L/&Xo"2<yuQk>!. <vCFb|"2T7AoW7pk)[7wWR+q5uVF_!VI]Ox@xXxTx}#>R	]mT!{Nk{
;?DcKLFeR-x<{|q~H>Db4s6LlLw|GN~n7Ck9
Y@nS>?\Y9Hip=ru`Oal hHM5xkx4N	oye i+=A6 ld\pS&l%8f7mALuJ%jSY9eDSdjJ(*m"Z};U;cjt]9Jl\m:jACVz7ljqHojnQc#=lIQv}U=8]}IbT9qN

XXtB:[m4&MJpW(r2dhevl~j3Q Zq=,k%t!Yo~+G[]jexg5YPg=h5f>`:7^ O#oCmqiQQkQNnLZ>,!bz":_7[{Y
*I!jTQUEUE13,c,f)Jm6*Jh!*;$T$EVe4c(l2{Y
uuB
(K(TwvD9*DvoJ@w@R,*bdOQ-OR{eu<OcPN%@.,HW4Gh}h+c}cn2(N-h[pX,!\33b6@F@7DD BYTo(^Lv3g &z(6PH{('|pd\46<_Axq"^+QuP22~MZBn176`ZwvEsGA:Bm3d};|80WNk0@ZzP1$/ `s!2<f;,8|SFoo-@k-C-hsEcJI7p+mWe wMr}^1sP:-,>Z~;(x8}S7mYZVzjzH4ZaX#d<Wq}k5M~X8+`CVO5x\8yI3}f'i90'7/a/{>iMORE+h@9g7#UCq_UL,_E8Jdx>WIGaOPX AA.'Z=c`lnvkN<^L+rPvYk<
>1)<:a]r{y;z,#CE^Ta <(z2v
F?R4ol-E>-+D.bA-~9QD{R\W\K@p%)-&NJ	HI=4sdPrK@RFswB1M{|Y8vTX[tq9Nj uq/BKmb*^G~{)gedbD_|,[_&uwrWjL 3e=),5+Dm{FvrKuN!=+l.@BDp{^~7w(w#w{?r;'n4M88fmz8O!r#l8XSv2d`5s_W^v?[8oe	|M	$)XC8#Ph9<]c_MR^}Xmt ,-6""\(+O85}7_,1YT~Felo@/=aT5
Y? %LrWhEHY~]wjGw\NAPZp54>s]TNMSU]Vr~WPT%xZ=RG9qk0V?Q	:TW5t	5Ur| jk>um;ub-.(_(
v + Y1P-8=Y:N.Wm,e9cL:~
y7pYk_qwkZpt4?x72c@h '3<lz9F!c%g_88fZi-%fz0#hInX$mC+zFVOOjVTjjfWTTBSh"cUfy	nni\n:J#`AXP.8zB
pfxo1;wpBvl7GDI7*s:/Jke2S_$PM'vB+_7FZE)%:3=-ln=vyeM8:Ha8Bv=h)L$c.EEz
[/9eq7kfcYP43]Jag'|+@q[Ry3 -./J3Bh
|Wv]DX8a'8Hqws@Z
c J|tTK#}jQxX'gy#sy~vT)<.-eOHgU=z-{u8e=gNn3d z"=0%.u;SPg
6U0Tjmc	iM &A	ej"6
gDBCn..'}-{Fwii',/;0dPwHCX}I%VaE[8M9sE1j?,eo"g}	3QrtyKn[:^fs?b raw].Ii+=9o"3V0FOfO[5">nD074tyf[h@!qc0t1l:9#%0|eFlLG"eIfV%mLMo]ihTGoG?6Z,]bK?9~	vf:SF9P 
)Q]&^6>B<@W%S@>Q#L@#u]$RXm!Dt>#BQGOs`[0=7gjHhiVCSEI]`0}kTeYDh.c_VW=]|Dr*jPYWdWb{}."8E>Z"hPdBIV}e4koGv1Z4{3*a}!Ymt_085^[el4WVii
BKbLuXO8]C=vg=tnM+O.[s;,eiui>m)v<U.Y0X]wE(!J5
+GCn%E	+4\6~L|hR#SejHj~|ddG>4{8*_uv7j.wnA`.;J18&n+YLSx>_-k])kaD9)hO2`KS\m':$[G!MyR|yL5v5KfQaVx%;.ITEtI[1+H![yo7smNudWXat%KdspPmZv6f)w(Z"Z"H5Q&\6a4R[Y&Ko
_sm;G(e !+v'yo	G+k-Y_
=Vd:2VPq	jp( =b,,qX 92<e@b!$K\anR$LlBNekG\KVR7+>HA@*@[.>
	"^A=$X|{Y0Qwl gPp 25d>FQ\bF3 2B-dY of#9-J0=JW`TLPUD-~Bk\-E!NcS#7%<||HGlK#uGWn@42.@>!kOPEcjI4)eS4P#a|]AS4Y~yYL)J$BDz$bT(-4jr#V\e5M4!`Mtz}2#{nIycvuUi*JK}K3lX"lCl`0&>K$%*DTl, 0u]G+'lc@pI2T2x86QsCy7
	U2IF>VKQzN(r#|e?r8fwz-EMw>;au.|vS`I[`S]=bcHD@QVPY&eP<<XIN%~4\?cG'N(;sAW9``wWJv0j;Z&F-r"|~iyeXX_[%dL}vU( R^
'1
*s'6G@'ZUH<}(M+!z!/#]%_697E.$8C{0>=Xyi%{hAsd=.Qg=%Fvs )#Ysc;5h
5VUzV(3;HOJI,OXs(1ts.Y"BZ&kEc+Q{EZ0&NqrhFItk:|$kvS#Xer.oevw=xz*2|l0QYFw8nRe[xKc]xp'pKox|Z)6GT8.\+,qCWMwN'KE9Y2lg7>mKd>88(ZEk3>i`/rUqWu={h!yW?}[TIlqy;H|q iRD(VR%d/xR<)
dyFa9O>A;By^-hVYycOHN?8tXb72b9{nBHj {X]e=Xze)Mu1 -K,@}MW 6\~-6]}WoS7451wEOO6^4
Bp(uEq;TDnHhFKCVZ|vvdnf("|!#7}m]#wpu?5E6VJ;I?@"m&w.O*l%[=}BW`+>A<\(o5h~||AF,7U^oq=_J
.*5+W
f"%fv]MOrmP2#=;v21Q?;5nH7}$e+8BsU#MtDfMm*j&z&=oV/=WWiX4)wg5s51z!Q%JMUssY["()v ?>k@vlc !R97nz(ZH|t%==lSCMJXb8w|*HtPy&\wGxq;uF(eD]B=oK~xN4x	-/l) <"HqAEz(`v}rY(].NHB-@MieI4GvG>qcH.xnhScc$2xuL@uA$Y;/"a$jZ;$)\	)N{cn^>ub cM0lbE>GyW`ZM(d[%Yqc8|1DuO`nNYcAe6`7an*~j	tFU'8l-e+iVUNcd|Cd\r]-l-nb+8-7oe@.0;H_"fIgA5|	~\-OBjJLY8/<Sx<5!{*t/
~!EVd9M;vLx7/w0WZTMTH~#S+;QXi-{K\iQrlr pE#Q5NiIG'}s)x^n|w
j!c?Pj-q._y\{'
|:H(Gv67p?Ip\&N!.pj>-CBW(YFRjy@C_=Zj=k3QGX-:JWug` X1Yu$_?k_dWk,Y}s{6+SvzY;PK;b!M{"&O`|s#}cq3y1%@{7(yW6?EA Tz\sQcSSKYb g:~l!#!.]?u;-qL[c.|(; bH2?'q0kFXXi2pia^G3)M1/t5kl!s915ueUD|]CNYrulI$r'}C6*w\<|V %P9>'inlsRw#*=
O9KOVo1w>TvZqe*Bk\X+uJ3Qvr:SH+$;a&FKcI%\SNqBZ.o=By4f+'6&|!|ve{?y*wi+W0R
XUg{_E,)lLO^_2j&k;>FT4"+L^Q~c-}%A $B(%z^&=xcTo{$8X>AkDVwl)K^8*w $<Y/Klfbkho3QtoOhKYvY^tbIuo%k#DTW_wXDXHp!1*@{`U?mIUnvZs^JU9<iw<KNjI`xK4`)5}#`kzj,A,	 i (yyn2y`8$	V9Z/W#N>Imo*M}NVoZk~i)/b5MMWfXrM
OE[EjSx>nSM]8COC`=JmC<U-'"w|G|SG+xb#wm0u+CV/n9p^<F:Q+4dn7u(tx&SV?{ 3]Z'"m[E3R*;OS(g RVo0qJ@RR/zW}T)S'v
'|2*1U` @4*!,27`pp1UHOFg-hR&5Xjl2294TKI{*fgYg0C,:95*gH6	S/|U<]*x2	: +W\	>K,b[EN%ygv651<w&!/>trK]7vSsb
Ky<X E$}>XFE1fUz^#g#rl+^gVVV[3-$z#-qLL;R6&__o)	J(UazVUI>wM2 E=U5Q
V:n<_$)e5!E}:Y(9_0uV S$1FIP&\dcOvF-V %Od='B.8u-I7l=.JJHMTS=QK%$v(|lkbYo?
@n4p72]7 bE_hx)-no&}Gf-aNY8EO8.S4*>aJd9Fs	L)Ufeh~t*iR-=n@&<jP:ERx^&za!l2H<S#6dl7ooQ[jI=:FctkV{zw]{}x0'66x	<!2!! !/	K}Z3ky>[_k; 8VIkVvWM0$O#D=s
 LZ(QR>g8HeF5r7-Ofyce8d1$hH$6Ds!m`}U!)j6EdmO$75um,er9<e,SGN)&	,HIM_f8u$_F4Q-jR+VQ|gZ 8C[U!-/<H#:0H|Td>~1v3]KEIY#A[W=<w]>yI_sU+)3pl8CBH2OPB_B_(MNe*N#xjr][+E>v3DPIoCcRF
%h)QCN&q(*oX_< 0'oozQF]K?d8=XbvJ|0B/-eFa^`TNr5f}M83,SgpNk.'csSL1S+x	b]m6	n>8y0Dee.fg7?#"\?]ZUTG<b
 ,: bN\E^Vs[J'?
VZtI6?$A@1'NO93{~p'5ah\<eol"F2%s;7+X:ZL,9JAMttEvOOUSPUC`!2T2nAos2/G{Mmr/8%-oj0s@LrQj%2{FMaPf\QBg/u'(hQ3BHf}B>|9GyR~6OFM	1)|Ke&]l6/|f:`>
Y&zEt?*3~N d,OyF|G%"-wmQ%<{}A/M$\\[s/un+Fc-s|I'9(!2SGDy.gNT{yYt9ZR,PG(d}[c_6D]g5lyRg<R	9q#1a'|,K8G|`1 _c&.w7>|J7k;#%t]Q/aTS7acq[+jFUnTd9[C,.]{V~0	V,Pq4fO%Tysx63 H)Xm .m=&1fpM	H=pKrMWR6-#mHS
8eIr:!iaF65odU4CAH14*)IZ$TeBWu\YM&aLId2#,].m&<<=XM&mc+ uxh#"d\&qCC&HW?zABH$lmk?bR}7$>;(e%o[Q{09{l;+vOnr\uj{	[N hg0[|>-UnCt$SxpAQ$iIR{Y	TyQ1LmPo_^:b}8itY>KN4JN7K/=V7ux)Ip/0*i9f1.bmE-W(6R"N (7?&&fp4`ky#_o7jv&4r>X$ <=0('7hu,eG7bw^&-IUQ&$#QTh$8F$o8{kI
(PJ)O$S-9hnPhW?n(Fh6/kvX.E+t$sh~_4f^|)OxWbLeX'De=WV<.'q~J9F>:ma4phFejt6E/|RZRb.,<	<`6b2J*^1sLp^6[K%vBg~kLnZn E3p=>Q%A2J~AFo_o|4x<dH4M!_,O]C%,lDfxdwd_jX)i\+ESfp c62v'laWA7BU!]%44SQX-	$n@9xzXN]s	(\#'&0SGoaRV:[DTKK/Wk?&"]Ay9j1;0CTiXC^E`Q|7]A+p"QZ6@APs/VaR(B6S	#tFuI>"&jo>=&-o
%XwzT^U}#rZB2*g?6EysNE9Qo`><8K.w3erf,XJ@7;b?36KNV@c2G_ONz/ZE1{FL*WvRUCjyC^"/E`_*K,, -\qtQp<QQDr<IUKIKzIi8*rm%uvQ9l=t'W9([iT	|29jB[F1l4vu	x]kt:hwr5c-M"CPd"?0y8h2;<	zBXxz:K!?{tW`>|k:M-=gc##L/Hz
 ?bcf$1QK\?VsGV:B6{fnpQ)Wt\l:1s(gknyz&z^.NW7fPc?Z4;?{PqfM%$#Z?)W?1<H3